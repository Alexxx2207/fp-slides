%%% стандартни пакети

% поддръжка на български език
\usepackage[T2A]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage[english,bulgarian]{babel}
\deftranslation[to=bulgarian]{Theorem}{Теорема}
\deftranslation[to=bulgarian]{Definition}{Дефиниция}
\deftranslation[to=bulgarian]{Corollary}{Следствие}

% поддръжка на линкове
\usepackage{hyperref}

% използване на специални апострофи и кавички
\usepackage{textcomp}

% форматиране на код: общи настройки
\usepackage{listings}
\lstset{
  showstringspaces=false,
  columns=fullflexible,
  keepspaces=true,
  extendedchars=false,
  keywordstyle=\color{blue},
  texcl=true,
  basicstyle=\ttfamily,
  escapechar=@
}

% форматиране на код на Haskell
\lstdefinestyle{Haskell}{
  commentstyle=\color[rgb]{0.133,0.545,0.133},
  stringstyle=\color[rgb]{0.75,0.49,0.07}
}

% двойни разделителни черти в таблици
\usepackage{hhline}

% зачертан текст
\usepackage{soul}

% дървета
\usepackage{forest}

% коментари
\usepackage{comment}

% цветни таблици
\usepackage{colortbl}

% вертикално сливане на клетки
\usepackage{multirow}

% клетки с диагонална черта
\usepackage{diagbox}

% умни интервали
\usepackage{xspace}

% вертикално подравняване на \includegraphics
\usepackage[export]{adjustbox}

%%% настройки общи за всички слайдове
\mode<presentation>
{
  \usetheme{CambridgeUS}
  \usecolortheme{dolphin}
}
\author{Трифон Трифонов}
\institute[ФП-И 17/18]{\small Функционално програмиране, 2017/18 г.}
\subject{LectureSlides}

%%% кратки команди за форматиране

% код
\renewcommand{\tt}{\texttt}

% код с форматиране
\newcommand{\lst}{\lstinline}

% код в червено
\newcommand{\tta}[1]{\tt{\alert{#1}}}

% зачертан код в червено
\newcommand{\sta}[1]{\tta{\st{#1}}}

% машина на Тюринг по даден код
\newcommand{\mt}[1]{\{#1\}}

% стрелка надолу за вериги от оценки
\newcommand{\bda}{\big\downarrow}

% стрелка нагоре за вериги от среди
\newcommand{\bua}{\big\uparrow}

% по-приличен pause (за математика и таблици)
\newcommand{\nxt}[1]{\visible<+->{#1}}

% \pause за таблици
\newcommand{\tpause}{\noalign{\pause}}

% среда
\newcommand{\env}[1]{$\mathbf{#1}$}

% оценка в среда
\newcommand{\inenv}[1]{\{\env{#1}\}}

%%% макроси

% оценява се до...
\newcommand{\evalstox}[1]{\lst!#1! $\longrightarrow$}

% оценява се до стойност
\newcommand{\evalsto}[2]{\evalstox{#1} \lst!#2!}

% оценява се до стойност без \lstlisting
\newcommand{\evalstos}[2]{#1 $\longrightarrow$ #2}

% не завършва
\newcommand{\evalstoinf}[1]{\evalsto{#1}{...}}

% оценява се до стойност с пауза за въпрос
\newcommand{\evalstop}[2]{\evalstox{#1} \rvl{\lst!#2!}}

% оценява се до стойност с пауза за въпрос без форматиране
\newcommand{\evalstops}[2]{\evalstos{#1} \rvl{\tt{#2}}}

% грешка при оценяване
\newcommand{\evalstoerr}[1]{\evalstox{#1} \textsf{\alert{Грешка!}}}

% грешка при оценяване без lstlisting
\newcommand{\evalstoerrs}[1]{\evalstos{#1}{\textsf{\alert{Грешка!}}}}

% грешка при оценяване с пауза за въпрос
\newcommand{\evalstoerrp}[1]{\evalstox{#1} \rvl{\textsf{\alert{Грешка!}}}}

% два израза се оценяват до една и съща стойност
\newcommand{\evalstwo}[3]{\lst!#1! $\longrightarrow$ \lst!#2! $\longleftarrow$ \lst!#3!}

% два израза се оценяват до една и съща стойност с пауза за въпрос
\newcommand{\evalstwop}[3]{\lst!#1! $\longrightarrow$ \rvl{#2} $\longleftarrow$ \lst!#3!}

% има тип
\newcommand{\typesto}[2]{\lst!#1 :: #2!}

% има тип с пауза за въпрос
\newcommand{\typestop}[2]{\lst!#1 ::! \rvl{\lst!#2!}}

% няма тип
\newcommand{\ntypes}[1]{\tta{#1 :{}: $\bot$}}

% няма тип с пауза за въпрос
\newcommand{\ntypesp}[1]{\alt<.(1)->\tta\tt{#1 :{}: \rvl{$\bot$}}}

% абстракция за кортеж и списък
\newcommand{\tuplelist}[3]{\tt{#1}$#3_1$\tt, $#3_2$\tt, $\ldots$\tt, $#3_n$\tt{#2}}

% кортеж
\newcommand{\tuple}{\tuplelist()}

% списък
\newcommand{\hlist}{\tuplelist[]}

% оценка на функция в среда
\newcommand{\funcenv}[3]{\begin{tabular}{||l@{\hskip 1ex}l@{\hskip 1ex}l||}%
                           \hline
                           Параметри&:&\tt{#1}\\
                           Тяло&:&\tt{#2}\\
                           Среда&:&\env{#3}\\
                           \hline
                         \end{tabular}
                         \\[-0.5\normalbaselineskip] &&}

% среда за среда :)
\newenvironment{envir}[1]{
  \begin{tabular}{|r@{\hskip 0.5ex}c@{\hskip 0.5ex}l|}
    \hline \multicolumn{3}{|c|}{\env{#1}}
}{
  \\\hline
  \end{tabular}
}

% двойна разделителна черта: слага се преди първия елемент в средата
\newcommand{\firstinenv}{\hhline{|*3{=}|}}

% откриване на въпрос
\newcommand{\rvl}[1]{\alt<+->{#1}?}

% син цвят по подразбиране
\colorlet{diagramblue}{blue!60!green!40}

% еквивалентно на
\newcommand{\eqv}{$\Longleftrightarrow$\xspace}

% обикновени кавички
\newcommand{\quot}{\textquotedbl}

%% диаграми

% стрелка напред, сочеща следваща клетка
\newcommand{\nextarrow}{\xrightarrow{\hspace{5ex}}}

% двойна кутия за точкова двойка
\newcommand{\pointcell}{\dualcell{\hspace*{2ex}}{\hspace*{2ex}}}

% двойна кутия за свързани структури
\newcommand{\dualcell}[2]{\multicolumn 1{|c|}{#1}&\multicolumn 1{c|}{#2}}

% двойна кутия със указател към следващата
\newcommand{\nextcell}{\pointcell&$\nextarrow$}

% двойна кутия без указател към следващата
\newcommand{\nilcell}{\dualcell{\hspace*{2ex}}{\scriptsize\diagbox[dir=SW]{\phantom a}{\phantom a}}}

% let in
\newcommand{\lett}[2]{\textbf{let }#1\textbf{ in }#2}

% where
\newcommand{\where}{\,\textbf{where}\,}